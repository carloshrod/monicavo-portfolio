---
import { Image } from 'astro:assets';
import PortfolioLayout from '../../../layouts/PortfolioLayout.astro';
import data from '../../../../sessions.json';
---

<PortfolioLayout title='MÓNICA JUVAROR - Portfolio Editorial' slug='editorial'>
	{
		data.map(item => (
			<a
				href={`/portfolio/editorial/${item.slug}`}
				class='hover imgContainer w-full md:w-1/2 lg:w-1/4 p-1 cursor-pointer'
			>
				<Image
					class='w-full object-cover dynamicLoading'
					src={item.cover}
					inferSize={true}
					alt={item.slug}
				/>
			</a>
		))
	}
</PortfolioLayout>

<style lang='scss'>
	.hover.imgContainer img {
		-webkit-filter: grayscale(100%);
		filter: grayscale(100%);
		-webkit-transition: 0.3s ease-in-out;
		transition: 0.3s ease-in-out;
	}
	.hover.imgContainer:hover img {
		-webkit-filter: grayscale(0);
		filter: grayscale(0);
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const dynamicImages = document.querySelectorAll('.dynamicLoading');

		function updateImageLoading() {
			const viewportHeight = window.innerHeight;
			dynamicImages.forEach(img => {
				const rect = img.getBoundingClientRect();
				if (rect.top < viewportHeight) {
					img.setAttribute('loading', 'eager');
				} else {
					img.setAttribute('loading', 'lazy');
				}
			});
		}

		// Inicializa la función al cargar la página
		updateImageLoading();

		// Actualiza al cambiar el tamaño de la ventana
		window.addEventListener('resize', updateImageLoading);
	});
</script>
